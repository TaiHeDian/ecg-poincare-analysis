# 心路历程

有肖博提供的手动[AMPD算法](https://zhuanlan.zhihu.com/p/549588865)、SciPy的[find_peaks](https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html)、NeuroKit2的[ecg_peaks](https://neuropsychology.github.io/NeuroKit/functions/ecg.html)。

手动算法是非常棒的，SciPy的寻峰算法就是大便，NeuroKit2的算法更是一坨狗屎。
还得靠手工书写，什么调包都是扯淡！

尝试把两个函数结合起来，成功地实现了庞加莱散点图的绘制。
但是这两个程序循环过多，运算时间消耗极其恐怖，是常人所不能忍受的！

用广播操作等替代原版程序中的for循环，将程序性能提升120倍，如果将ECG从在线示例换成本地数据还能更快。
![旧版程序性能](imgs/snakeviz-v0.png)
![新版程序性能](imgs/snakeviz-v1.png)

将椭圆绘制功能叠加到庞加莱散点图上。体会是Python繁杂难驾驭，夜深独叹月光幽。

将在线数据替换成本地数据，并进一步优化程序，又将性能提升了5倍。但这有什么用呢？虽破万难终无获，劳心费力空留痕！
